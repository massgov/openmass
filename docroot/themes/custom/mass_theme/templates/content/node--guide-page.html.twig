{#
/**
 * @file
 * Theme override to display the full view mode of the Guide page content type.
 *
 */
 #}
{# This template initially extended '@templates/stacked-row-template.twig',
    but that caused to add second set of <main> from that tempate. #}
{# {% block header %}
  {% if ajaxEmergencyAlerts %}
    {% set ajaxPattern = ajaxEmergencyAlerts %}
    {% include "@organisms/by-template/ajax-pattern.twig" %}
  {% endif %}
{% endblock %}

{# Set top heading level for the page. #}
{# {% set level = 1 %}

<div class="pre-content">
{% block preContent %} #}
  {# If the contextual navigation should be set for this node, then add it. #}
  {# {% if node.computed_log_in_links is not empty %}
    {{ contextual_log_in_links }}
  {% endif %} #}

  {# Check if primary indicator content exists. #}
  {# {% set primaryIndicators = null %}
  {% set primaryRelationshipContent = null %} #}
  {#
  {% if content.computed_related_to[0] %}
    {% set primaryIndicators = { "label": "part of" } %}
    {% set primaryRelationshipContent = content.computed_related_to %}
  {% endif %}
  #}
  {# {% set secondaryIndicators = false %}
  {% if content.field_organizations is not empty %}
    {% set secondaryIndicators = {
      "icon": "building",
      "label": "offered by",
      "groupAfter": 3
    } %}
  {% endif %}

  {% embed "@molecules/relationship-indicators.twig" with {
    "relationshipIndicators": {
      "pageTitle": node.label,
      "primary": primaryIndicators,
      "secondary": secondaryIndicators
    }
  } %}
    {% block primaryRelationship %}
      {{ primaryRelationshipContent }}
    {% endblock %}
    {% block secondaryRelationship %}
      {{ content.field_organizations }}
    {% endblock %}
  {% endembed %}
  {% include "@organisms/by-template/illustrated-header.twig" with {
    "illustratedHeader": {
      "bgImage": content.field_guide_page_bg_wide[0],
      "noImage": content.field_guide_page_bg_wide[0]?false:true,
      "bgCentered": true,
      "pageHeader": {
        "title": node.title.value,
        "subTitle": "",
        "optionalContents": [{
          "path": "@organisms/by-author/rich-text.twig",
          "data": {
            "richText": {
              "rteElements": [{
                "path": "@atoms/11-text/paragraph.twig",
                "data": {
                  "paragraph" : {
                    "text": content.field_guide_page_lede | render
                  }
                }
              }]
            }
          }
        }],
        "headerTags": null
      }
    }
  } %}
  {% include "@organisms/by-template/sticky-toc.twig" with {
    "stickyTOC": {
      "title": "Table of Contents"|t,
      "parent": "#main-content",
      "sections": ".ma__stacked-row__title h2"
    },
  } %}
{% endblock %}
</div>
<div class="ma__stacked-row">
{% block stackedRowContent %}
  {# Increase heading number by 1 from the parent heading. #}
  {# {% set level = level + 1 %}
    {{ content.field_guide_page_sections }}
{% endblock %}
</div>
<div class="post-content">
{% block postContent %}
  {% if content.field_image_credit is not empty %}
    {{ content.field_image_credit }}
  {% endif %}
  {% if node.field_guide_page_related_guides.value %}
    {% include "@organisms/by-author/suggested-pages.twig" %}
  {% endif %}
  {{ content.extra_org_feedback_form }}
{% endblock %}
</div>
{% block schemaContent %}{% endblock %}
{% block footer %}
  {% include "@organisms/by-template/footer.twig" %}
{% endblock %} #}



{# ORIGINAL TEAMPLATE #}
{% extends '@templates/stacked-row-template.twig' %}

{% block header %}{% endblock %}

{# Set top heading level for the page. #}
{% set level = 1 %}

{% block preContent %}
	{# If the contextual navigation should be set for this node, then add it. #}
	{% if node.computed_log_in_links is not empty %}
		{{ contextual_log_in_links }}
	{% endif %}

	{# Check if primary indicator content exists. #}
	{% set primaryIndicators = null %}
	{% set primaryRelationshipContent = null %}
	{#
	  {% if content.computed_related_to[0] %}
	    {% set primaryIndicators = { "label": "part of" } %}
	    {% set primaryRelationshipContent = content.computed_related_to %}
	  {% endif %}
	  #}
	{% set secondaryIndicators = false %}
	{% if content.field_organizations is not empty %}
		{% set secondaryIndicators = {
      "icon": "building",
      "label": "offered by",
      "groupAfter": 3
    } %}
	{% endif %}

	{% embed "@molecules/relationship-indicators.twig" with {
    "relationshipIndicators": {
      "pageTitle": node.label,
      "primary": primaryIndicators,
      "secondary": secondaryIndicators
    }
  } %}
		{% block primaryRelationship %}
			{{ primaryRelationshipContent }}
		{% endblock %}
		{% block secondaryRelationship %}
			{{ content.field_organizations }}
		{% endblock %}
	{% endembed %}
	{% include "@organisms/by-template/illustrated-header.twig" with {
    "illustratedHeader": {
      "bgImage": content.field_guide_page_bg_wide[0],
      "noImage": content.field_guide_page_bg_wide[0]?false:true,
      "bgCentered": true,
      "pageHeader": {
        "title": node.title.value,
        "subTitle": "",
        "optionalContents": [{
          "path": "@organisms/by-author/rich-text.twig",
          "data": {
            "richText": {
              "rteElements": [{
                "path": "@atoms/11-text/paragraph.twig",
                "data": {
                  "paragraph" : {
                    "text": content.field_guide_page_lede | render
                  }
                }
              }]
            }
          }
        }],
        "headerTags": null
      }
    }
  } %}
	{% include "@organisms/by-template/sticky-toc.twig" with {
    "stickyTOC": {
      "title": "Table of Contents"|t,
      "parent": "#main-content",
      "sections": ".ma__stacked-row__title h2"
    },
  } %}
{% endblock %}

{% block stackedRowContent %}
	{# Increase heading number by 1 from the parent heading. #}
	{% set level = level + 1 %}
	{{ content.field_guide_page_sections }}
{% endblock %}

{% block postContent %}
	{% if content.field_image_credit is not empty %}
		{{ content.field_image_credit }}
	{% endif %}
	{% if node.field_guide_page_related_guides.value %}
		{% include "@organisms/by-author/suggested-pages.twig" %}
	{% endif %}
	{{ content.extra_org_feedback_form }}
{% endblock %}

{% block footer %}{% endblock %}
